---
title: "Final Project: Online Sales Analysis "
authors: "Khushi Satra, 203383100
          Satinder Kaur, 169109308
          Sara Haifa, 169087012
          Spencer Mozeg , 169099531
          Noya Barak, 
---


#Load packages
```{r}
library(tidyverse)
library(tidymodels)
```
#Load datasets
```{r}
Movie_industry<- read.csv("https://raw.githubusercontent.com/khushisatra/Final-Project/refs/heads/main/movies.csv")
Movie_industry
```
{r}
movie_industry <- na.omit(Movie_industry)
movie_industry

#Step 1: Tidying 
```{r}
clean_movie_industry <- movie_industry|>
  mutate(
  released_date = str_extract(released, "^[A-Za-z]+ \\d{1,2}, \\d{4}"),
  hours = runtime%/%60,             
    minutes = runtime %% 60, 
    movie_duration = sprintf("%d hours, %d minutes", hours, minutes),
  rating = ifelse(rating == "X", "NC-17",
                         ifelse(rating == "Approved", "G", rating)),
   Profit = gross - budget
  ) |>
  select(-released, -year, -hours, -minutes, -runtime)|>
  filter(rating != "Not Rated" & rating != "Unrated")|>
   mutate(genre = as.factor(genre),
  rating = as.factor(rating))|>
  rename(
    IMDb_score = score,
    user_votes = votes,
    gross_revenue = gross
  )
  
clean_movie_industry

```
#Exploratory Plot 1

profit_by_genre <- clean_movie_industry|>
  group_by(genre)|>
  summarise(avg_Profit = mean(Profit)) |>
  arrange(desc(avg_Profit))

ggplot(profit_by_genre, aes(x = reorder(genre, avg_Profit), y = avg_Profit, fill = genre)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() +
  labs(title = "Average Profit by Genre", x = "Genre", y = "Average Profit") +
  theme_minimal()
